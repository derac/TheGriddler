<Window x:Class="TheGriddler.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TheGriddler.Views"
        xmlns:converters="clr-namespace:TheGriddler.Converters"
        xmlns:models="clr-namespace:TheGriddler.Models"
        Title="The Griddler" Height="500" Width="700"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        Icon="../Resources/icon.png"
        MouseDown="Window_MouseDown">
    
    <Window.Resources>
        <converters:HexToBrushConverter x:Key="HexToBrushConverter" />
        
        <!-- Dark Mode Brushes -->
        <SolidColorBrush x:Key="DarkBg" Color="#1E1E1E" />
        <SolidColorBrush x:Key="DarkBgLighter" Color="#2D2D2D" />
        <SolidColorBrush x:Key="DarkFg" Color="#FFFFFF" />
        <SolidColorBrush x:Key="DarkBorder" Color="#3F3F46" />
        <SolidColorBrush x:Key="Accent" Color="#007ACC" />
        
        <!-- Light Mode Brushes -->
        <SolidColorBrush x:Key="LightBg" Color="#F3F3F3" />
        <SolidColorBrush x:Key="LightBgLighter" Color="#FFFFFF" />
        <SolidColorBrush x:Key="LightFg" Color="#000000" />
        <SolidColorBrush x:Key="LightBorder" Color="#CCCCCC" />

        <Style x:Key="PanelStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource DarkBg}" />
            <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsDarkMode}" Value="False">
                    <Setter Property="Background" Value="{StaticResource LightBg}" />
                    <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="TextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource DarkFg}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                    <Setter Property="Foreground" Value="{StaticResource LightFg}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Foreground" Value="{StaticResource DarkFg}" />
            <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                    <Setter Property="Foreground" Value="{StaticResource LightFg}" />
                    <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="TextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource DarkBgLighter}" />
            <Setter Property="Foreground" Value="{StaticResource DarkFg}" />
            <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
            <Setter Property="Padding" Value="5,2" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                    <Setter Property="Background" Value="{StaticResource LightBgLighter}" />
                    <Setter Property="Foreground" Value="{StaticResource LightFg}" />
                    <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border CornerRadius="10" BorderThickness="1" Style="{StaticResource PanelStyle}" ClipToBounds="True">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Grid Grid.Row="0" Background="Transparent">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="15,0">
                    <Image Source="/Resources/icon.png" Width="20" Height="20" Margin="0,0,10,0" />
                    <TextBlock Text="The Griddler" FontWeight="Bold" VerticalAlignment="Center" Style="{StaticResource TextBlockStyle}" />
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="5">
                    <Button Content="💡" Click="ToggleTheme_Click" Width="30" Height="30" Background="Transparent" BorderThickness="0" Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Foreground" Value="{StaticResource DarkFg}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsDarkMode}" Value="False">
                                        <Setter Property="Foreground" Value="{StaticResource LightFg}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    <Button Content="✕" Click="Close_Click" Width="30" Height="30" Background="Transparent" BorderThickness="0" Foreground="Red" FontWeight="Bold" Cursor="Hand" />
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1" Margin="15,0,15,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="250" />
                </Grid.ColumnDefinitions>

                <!-- Left Column: Monitors -->
                <GroupBox Header="Monitor Grid Configuration" Grid.Column="0" Margin="0,0,10,0" Style="{StaticResource GroupBoxStyle}">
                    <ListBox ItemsSource="{Binding MonitorConfigs}" Background="Transparent" BorderThickness="0" HorizontalContentAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,5" Padding="10" CornerRadius="5">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="{StaticResource DarkBgLighter}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                                                    <Setter Property="Background" Value="{StaticResource LightBgLighter}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" VerticalAlignment="Center" Style="{StaticResource TextBlockStyle}"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="Cols:" VerticalAlignment="Center" Margin="10,0,5,0" Style="{StaticResource TextBlockStyle}"/>
                                            <TextBox Text="{Binding Columns, UpdateSourceTrigger=PropertyChanged}" Width="40" TextAlignment="Center" Style="{StaticResource TextBoxStyle}"/>
                                            <TextBlock Text="Rows:" VerticalAlignment="Center" Margin="10,0,5,0" Style="{StaticResource TextBlockStyle}"/>
                                            <TextBox Text="{Binding Rows, UpdateSourceTrigger=PropertyChanged}" Width="40" TextAlignment="Center" Style="{StaticResource TextBoxStyle}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </GroupBox>

                <!-- Right Column: Colors and Apps -->
                <StackPanel Grid.Column="1">
                    <GroupBox Header="Visual Settings" Style="{StaticResource GroupBoxStyle}">
                        <StackPanel Margin="5">
                            <TextBlock Text="Grid Lines" Margin="0,5,0,2" Style="{StaticResource TextBlockStyle}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBox Text="{Binding GridColor, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource TextBoxStyle}" />
                                <Button Grid.Column="1" Width="24" Margin="5,0,0,0" Background="{Binding GridColor, Converter={StaticResource HexToBrushConverter}}" Tag="GridColor" Click="PickColor_Click">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                                                    <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>

                            <TextBlock Text="Selection Area" Margin="0,10,0,2" Style="{StaticResource TextBlockStyle}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBox Text="{Binding SelectionColor, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource TextBoxStyle}" />
                                <Button Grid.Column="1" Width="24" Margin="5,0,0,0" Background="{Binding SelectionColor, Converter={StaticResource HexToBrushConverter}}" Tag="SelectionColor" Click="PickColor_Click">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                                                    <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>

                            <TextBlock Text="Selection Border" Margin="0,10,0,2" Style="{StaticResource TextBlockStyle}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBox Text="{Binding SelectionBorderColor, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource TextBoxStyle}" />
                                <Button Grid.Column="1" Width="24" Margin="5,0,0,0" Background="{Binding SelectionBorderColor, Converter={StaticResource HexToBrushConverter}}" Tag="SelectionBorderColor" Click="PickColor_Click">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                                                    <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>

                            <Button Content="Reset to Defaults" Margin="0,15,0,0" Click="ResetColors_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Padding" Value="10,5" />
                                        <Setter Property="Background" Value="Transparent" />
                                        <Setter Property="Foreground" Value="{StaticResource DarkFg}" />
                                        <Setter Property="BorderBrush" Value="{StaticResource DarkBorder}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.IsDarkMode}" Value="False">
                                                <Setter Property="Foreground" Value="{StaticResource LightFg}" />
                                                <Setter Property="BorderBrush" Value="{StaticResource LightBorder}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="App Settings" Margin="0,10,0,0" Style="{StaticResource GroupBoxStyle}">
                        <StackPanel Margin="5">
                            <CheckBox Content="Run on Startup" IsChecked="{Binding RunOnStartup}" Margin="0,5" Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=GroupBox}}"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Info" Margin="0,10,0,0" Style="{StaticResource GroupBoxStyle}">
                        <TextBlock TextWrapping="Wrap" FontSize="11" Opacity="0.8" Style="{StaticResource TextBlockStyle}">
                            While dragging a window by holding left click, right click in the grid section you want to resize from, continue dragging left click to the grid section you want to resize to and press right click again or let go of left click.
                        </TextBlock>
                    </GroupBox>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
